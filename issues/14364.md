# (14364) add serde-bincode-compat for receipt

**issue**: https://github.com/paradigmxyz/reth/issues/14364

**issue tldr**: the `Receipt` trait is missing the `MaybeSerdeBincodeCompat` bound, which means receipt types (especially Optimism receipts with `#[serde(skip)]` fields for RPC compatibility) cannot be properly serialized to bincode for disk storage. This breaks the `Chain` struct's bincode serialization when it contains `ExecutionOutcome<Receipt>`.

**explainer**: `SerdeBincodeCompat` is a trait that provides an alternative serde representation (`BincodeRepr`) for types that need different serialization formats for JSON-RPC vs binary disk storage. Some types (like Optimism's `DepositReceipt`) have fields that are `#[serde(skip)]` for RPC responses but **must** be persisted when storing chain data via bincode. The `BlockHeader` trait already requires `MaybeSerdeBincodeCompat` (see `block/header.rs:32`), allowing custom bincode representations. However, the `Receipt` trait lacks this bound. When `Chain` (in `chain.rs`) serializes via bincode, it wraps blocks in bincode-compatible wrappers but leaves `ExecutionOutcome<N::Receipt>` using plain serde—causing fields to be lost for receipt types that skip fields for RPC. The fix adds the trait bound so receipts can define their own `BincodeRepr` that preserves all fields.

**files involved**:
- `reth/crates/primitives-traits/src/receipt.rs`: defines the `Receipt` trait that all receipt types must implement—currently missing `MaybeSerdeBincodeCompat`
- `reth/crates/primitives-traits/src/serde_bincode_compat.rs`: defines `SerdeBincodeCompat` trait and `MaybeSerdeBincodeCompat` marker trait for types needing custom bincode serialization
- `reth/crates/primitives-traits/src/block/header.rs`: shows the pattern—`BlockHeader` already has `+ MaybeSerdeBincodeCompat` bound (line 32)
- `reth/crates/evm/execution-types/src/chain.rs`: the `Chain` bincode struct that serializes `ExecutionOutcome<N::Receipt>`—needs a bincode helper for the receipt field
- `reth/crates/evm/execution-types/src/execution_outcome.rs`: defines `ExecutionOutcome<T>` which contains `receipts: Vec<Vec<T>>`—will need bincode compat impl

**what the fix does**:
1. adds `+ MaybeSerdeBincodeCompat` to the `Receipt` trait bounds in `primitives-traits/src/receipt.rs` (line 28), matching what `BlockHeader` already does
2. implements `SerdeBincodeCompat` for `Receipt` (ethereum) in `ethereum/primitives/src/receipt.rs` — returns `Self` since ethereum receipts don't skip any fields
3. implements `SerdeBincodeCompat` for `OpReceipt` (optimism) in `optimism/primitives/src/receipt.rs` — also returns `Self` for now (proper bincode repr with all fields is tracked separately in op-alloy#424)
4. enables the `serde-bincode-compat` feature for `reth-optimism-primitives` in the e2e test utils cargo.toml so tests can exercise the new impl
